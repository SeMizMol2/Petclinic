<template>
  <div class="custom-page-container">
    
    <div class="header-section">
      <div class="icon-wrapper">
        <span class="header-icon">üêæ</span>
      </div>
      <h1 class="page-title">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</h1>
      <p class="page-subtitle">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≠‡∏á‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏û‡∏ß‡∏Å‡πÄ‡∏Ç‡∏≤</p>
    </div>

    <div class="form-card">
      
      <form @submit.prevent="submitPet">
        
        <div class="form-group">
          <label class="input-label">
            <span class="label-icon">üè∑Ô∏è</span> ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á
          </label>
          <input 
            v-model="pet.pet_name" 
            class="input-field" 
            placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á" 
            required 
          />
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="input-label">
              <span class="label-icon">üêï</span> ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
            </label>
            <input 
              v-model="pet.pet_type" 
              class="input-field" 
              placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏∏‡∏ô‡∏±‡∏Ç, ‡πÅ‡∏°‡∏ß" 
              required 
            />
          </div>
          <div class="form-group">
            <label class="input-label">
              <span class="label-icon">üß¨</span> ‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå
            </label>
            <input 
              v-model="pet.pet_breed" 
              class="input-field" 
              placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÇ‡∏Å‡∏•‡πÄ‡∏î‡πâ‡∏ô‡∏£‡∏µ‡∏ó‡∏£‡∏µ‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå" 
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="input-label">
              <span class="label-icon">‚öß</span> ‡πÄ‡∏û‡∏®
            </label>
            <div class="select-wrapper">
              <select v-model="pet.pet_gender" class="input-field cursor-pointer" required>
                <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏®</option>
                <option value="‡∏ú‡∏π‡πâ">‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ</option>
                <option value="‡πÄ‡∏°‡∏µ‡∏¢">‡∏ï‡∏±‡∏ß‡πÄ‡∏°‡∏µ‡∏¢</option>
              </select>
              <span class="select-arrow">‚ñº</span>
            </div>
          </div>
          <div class="form-group">
            <label class="input-label">
              <span class="label-icon">üíâ</span> ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏´‡∏°‡∏±‡∏ô
            </label>
            <div class="select-wrapper">
              <select v-model="pet.sterile_status" class="input-field cursor-pointer" required>
                <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                <option value="‡∏ó‡∏≥‡πÅ‡∏•‡πâ‡∏ß">‡∏ó‡∏≥‡∏´‡∏°‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß</option>
                <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ó‡∏≥">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏´‡∏°‡∏±‡∏ô</option>
              </select>
              <span class="select-arrow">‚ñº</span>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label class="input-label">
            <span class="label-icon">‚ú®</span> ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡πÄ‡∏î‡πà‡∏ô / ‡∏™‡∏µ
          </label>
          <input 
            v-model="pet.pet_color" 
            class="input-field" 
            placeholder="‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏µ" 
          />
        </div>

        <div class="form-group">
          <label class="input-label">
            <span class="label-icon">üéÇ</span> ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î
          </label>
          <input 
            type="date" 
            v-model="pet.pet_birthdate" 
            class="input-field"
          />
        </div>

        <div class="form-group">
          <label class="input-label">
            <span class="label-icon">‚ö†Ô∏è</span> ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡πâ‡∏¢‡∏≤
          </label>
          <textarea
            v-model="pet.drug_allergy"
            class="input-field textarea-field"
            rows="3"
            placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏û‡πâ (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå '‡πÑ‡∏°‡πà‡∏°‡∏µ')"
          ></textarea>
        </div>

        <div class="button-group">
          <button type="submit" class="btn btn-save">
            <span>‚úì</span> ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
          </button>

          <router-link to="/user/pets" class="btn btn-cancel">
            <span>‚úï</span> ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
          </router-link>
        </div>

      </form>
    </div>

    <div class="footer-text">
      <span>üêæ</span> ‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å <span>üêæ</span>
    </div>

  </div>
</template>

<script setup>
import { ref } from 'vue'
import axios from 'axios'
import { useRouter } from 'vue-router'

const router = useRouter()
const token = localStorage.getItem('token')

const pet = ref({
  pet_name: '',
  pet_type: '',
  pet_breed: '',
  pet_gender: '',
  sterile_status: '',
  pet_color: '',
  pet_birthdate: '',
  drug_allergy: ''
})

const submitPet = async () => {
  if (!token) {
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô")
    router.push('/login')
    return
  }

  try {
    await axios.post(
      'http://localhost:3000/api/pets',
      pet.value,
      { headers: { Authorization: `Bearer ${token}` } }
    )

    alert('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! üéâ')
    router.push('/user/pets')

  } catch (err) {
    console.error("ERROR:", err.response?.data)
    alert(err.response?.data?.message || '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à')
  }
}
</script>

<style scoped>
/* =========================================
   CUSTOM CSS (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏ä‡πâ Style ‡∏ô‡∏µ‡πâ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô)
   ========================================= */

/* Main Page Container */
.custom-page-container {
  min-height: 100vh;
  background-color: #5a72ea; /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡∏ü‡πâ‡∏≤ */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 2rem 1rem;
  font-family: 'Inter', sans-serif;
}

/* Header Section */
.header-section {
  text-align: center;
  margin-bottom: 2rem;
  color: white;
}
.icon-wrapper {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 5rem;
  height: 5rem;
  background-color: rgba(255, 255, 255, 0.2);
  border-radius: 50%;
  margin-bottom: 1rem;
  backdrop-filter: blur(4px);
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
}
.header-icon { font-size: 2.5rem; }
.page-title {
  font-size: 2rem;
  font-weight: 800;
  margin: 0 0 0.5rem;
  text-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.page-subtitle {
  color: #bfdbfe; /* blue-100 */
  font-size: 0.95rem;
  margin: 0;
  opacity: 0.9;
}

/* Card Container */
.form-card {
  background-color: #ffffff !important; /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏Ç‡∏≤‡∏ß */
  width: 100%;
  max-width: 800px;
  border-radius: 2rem;
  padding: 2.5rem;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
  position: relative;
  box-sizing: border-box;
}

/* Form Styles */
.form-group { margin-bottom: 1.25rem; }
.form-row {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1.25rem;
  margin-bottom: 1.25rem;
}
@media (min-width: 768px) {
  .form-row { grid-template-columns: 1fr 1fr; }
}

.input-label {
  display: flex;
  align-items: center;
  font-size: 0.95rem;
  font-weight: 700;
  color: #374151; /* gray-700 */
  margin-bottom: 0.5rem;
}
.label-icon { margin-right: 0.5rem; }

.input-field {
  width: 100%;
  padding: 0.85rem 1rem;
  background-color: #fff;
  border: 1px solid #e5e7eb;
  border-radius: 0.75rem;
  color: #4b5563;
  font-size: 1rem;
  outline: none;
  transition: all 0.2s ease;
  box-sizing: border-box; /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Input ‡∏•‡πâ‡∏ô */
}
.input-field:focus {
  border-color: #6200ea;
  box-shadow: 0 0 0 3px rgba(98, 0, 234, 0.1);
}
.input-field::placeholder { color: #9ca3af; font-weight: 400; }

.textarea-field { min-height: 100px; resize: vertical; }

/* Custom Select */
.select-wrapper { position: relative; }
.select-arrow {
  position: absolute;
  right: 1rem;
  top: 50%;
  transform: translateY(-50%);
  color: #9ca3af;
  font-size: 0.75rem;
  pointer-events: none;
}
select.input-field { appearance: none; cursor: pointer; }

/* Buttons */
.button-group {
  display: flex;
  gap: 1rem;
  margin-top: 2rem;
}
.btn {
  padding: 0.85rem 1.5rem;
  border-radius: 0.75rem;
  font-weight: 700;
  font-size: 1rem;
  cursor: pointer;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  transition: all 0.2s;
  text-decoration: none;
}
.btn-save {
  flex-grow: 1;
  background-color: #6200ea; /* ‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á */
  color: white;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
}
.btn-save:hover {
  background-color: #5200d6;
  transform: translateY(-1px);
  box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
}
.btn-save:active { transform: translateY(0); }

.btn-cancel {
  background-color: #f3f4f6;
  color: #374151;
  min-width: 120px;
}
.btn-cancel:hover { background-color: #e5e7eb; color: #111827; }

/* Footer */
.footer-text {
  margin-top: 2rem;
  color: #bfdbfe;
  font-size: 0.875rem;
  opacity: 0.8;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

</style>